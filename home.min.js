function showMap(id, latitude, longitude, title, desc) {
    var contentString = '<p style="text-align:left;font-weight:600;font-size:120%;margin-bottom:10px;">' + title + '</p><p style="margin-bottom:0;">' + desc + '</p>';
    var uluru = { lat: parseFloat(latitude), lng: parseFloat(longitude) };
    var infoWindow = new google.maps.InfoWindow({
        content: contentString
    });
    var map = new google.maps.Map(document.getElementById(id), {
        zoom: 16,
        center: uluru
    });
    var marker = new google.maps.Marker({
        position: uluru,
        map: map
    });
    infoWindow.open(map, marker);
}
function searchDealer(id) {
    var objInput = $(id).find('.input-group input');
    var keyword = $(objInput).val().trim();
    var brand = $(id).find('select[data-field="brand"] option:selected').attr('data-code');
    var city = parseInt($(id).find('select[data-field="city"]').val());
    var url;
    var queries = new Array();
    var isValid = false;

    if (brand && brand.length > 0) {
        url = '/danh-sach-dai-ly-xe-oto-' + brand + '/';
        isValid = true;
    }
    else {
        url = '/danh-sach-dai-ly-xe-oto/';
    }
    if (city > 0) {
        queries.push('city=' + city);
        isValid = true;
    }
    if (keyword.length > 0) {
        queries.push('s=' + formatTextSearch(keyword));
        isValid = true;
    }
    if (isValid) {
        $('body').trigger('startLoading');
        if (queries.length > 0) {
            window.location.href = url + '?' + queries.join("&");
        }
        else {
            window.location.href = url;
        }
    }
    else {
        showAlertInfoFocus('Vui lòng nhập dữ liệu tìm kiếm!', objInput);
    }
}
function searchVehicle(id) {
    var queries = new Array();
    var fromPrice = null;
    var toPrice = null;
    var isValid = true;

    $(id).find('.box-search-left [data-field]').each(function () {
        var field = $(this).attr('data-field');
        var value = $(this).val();
        switch (field) {
            case "keyword":
                if (value && value.length > 0) {
                    queries.push('s=' + formatTextSearch(value));
                }
                break;
            case "fromprice":
                fromPrice = parseInt(value);
                if (fromPrice && fromPrice > 0) {
                    queries.push('from=' + fromPrice);
                }
                break;
            case "toprice":
                toPrice = parseInt(value);
                if (toPrice && toPrice > 0) {
                    queries.push('to=' + toPrice);
                }
                break;
            default:
                if ($(this).hasClass('checkboxpicker') && value.length > 0) {
                    if (field == 'brand') {
                        var brandId = parseInt($(id).attr('data-id'));
                        if (brandId > 0) {
                            var index = value.indexOf(''+brandId);
                            if (index > -1) {
                                value.splice(index, 1);
                            }
                        }
                    }
                    if (value.length > 0) {
                        queries.push(field + '=' + value.join(','));
                    }
                }
                break;
        }
    });

    var sort = parseInt($(id).find('.sort-product .btn-sort.active').attr('data-value'));
    if (sort && sort > 1) {
        queries.push('o=' + sort);
    }

    if (isValid) {
        $('body').trigger('startLoading');
        if (queries.length > 0) {
            window.location.href = getCurrentUrl() + '?' + queries.join("&");
        }
        else {
            window.location.href = getCurrentUrl();
        }
    }
}
function searchPriceList(id) {
    var queries = new Array();
    var isValid = true;

    $(id).find('.search-box-header [data-field]').each(function () {
        var field = $(this).attr('data-field');
        var value = $(this).val();
        switch (field) {
            case "keyword":
                if (value && value.length > 0) {
                    queries.push('s=' + formatTextSearch(value));
                }
                break;
            case "price":
                var optPrice = $(this).find('option:selected');
                var fromPrice = parseInt(optPrice.attr('data-from'));
                var toPrice = parseInt(optPrice.attr('data-to'));
                if (fromPrice && fromPrice > 0) {
                    queries.push('from=' + fromPrice);
                }
                if (toPrice && toPrice > 0) {
                    queries.push('to=' + toPrice);
                }
                break;
            default:
                value = parseInt(value);
                if (value > 0) {
                    queries.push(field + '=' + value);
                }
                break;
        }
    });

    if (isValid) {
        $('body').trigger('startLoading');
        if (queries.length > 0) {
            window.location.href = getCurrentUrl() + '?' + queries.join("&");
        }
        else {
            window.location.href = getCurrentUrl();
        }
    }
}
function addItemSearchVehicle(type, id, name) {
    var btn = $('<a class="tag-item" title="' + name + '" data-type="' + type + '" data-id="' + id + '"><span class="tag-value">' + name + '</span><i class="fa fa-times"></i></a>')
    btn.on('click touch', function () {
        var type = $(this).attr('data-type');
        var id = $(this).attr('data-id');
        switch (type) {
            case 'search':
                $('.row-vehicle .box-search-left .input-group input').val('');
                break;
            case 'price':
                $('.row-vehicle .box-search-left .box-search-item-price input').val('');
                break;
            default:
                $('.row-vehicle .box-search-left select[data-field="' + type + '"]').find('option[value="' + id + '"]').prop("selected", false);
                break;
        }
        searchVehicle('.row-vehicle');
    });
    $('.tag-search-product').prepend(btn);
}
function processDealerPage(ajax) {
    if (window.pageKey == 'dealerlist') {
        $('.search-dealer select[data-field]').each(function () {
            reloadCombobox(this, '.search-dealer', ajax);
            $(this).on('changed.bs.select', function (e, clickedIndex, isSelected, previousValue) {
                searchDealer('.search-dealer');
            });
        });
        $('.search-dealer .input-group button').on('click touch', function () {
            searchDealer('.search-dealer');
        });
        $('.search-dealer .input-group input').on('keypress', function (e) {
            if (e.keyCode == 13 || e.which == 13) {
                searchDealer('.search-dealer');
            }
        });
        $('.showroom-list .showroom-item .search-map').on('click tourch', function () {
            var googleMaps = $(this).attr('data-value');
            if (googleMaps && googleMaps.length > 0) {
                var temp = googleMaps.split(',');
                var latitude = temp[0].trim();
                var longitude = temp.length > 1 ? temp[1].trim() : 0;
                var dealerName = $(this).closest('.showroom-item').find('.showroom-title>a>span').text();
                var address = 'Địa chỉ: ' + $(this).closest('.showroom-item').find('.address>span').text();
                showMap('map', latitude, longitude, dealerName, address);
            }
        });
        $('.showroom-list .showroom-item:first-child .search-map').trigger('click');

        // Set value search
        $('.search-dealer .input-group input').each(function () {
            setTextSearch(this);
        });
    }
}
function processVehiclePage(ajax) {
    if (window.pageKey == 'vehiclelist') {
        // Click title
        $(".row-vehicle .box-search-item-title").on('click touch', function () {
            $(this).parent().toggleClass("active");
        });

        // Search keyword
        $('.row-vehicle .box-search-left .input-group input').on('keypress', function (e) {
            if (e.keyCode == 13 || e.which == 13) {
                $(this).closest('.input-group').find('button').trigger('click');
            }
        });
        $('.row-vehicle .box-search-left .input-group button').on('click touch', function () {
            var objTextSearch = $('.box-search-left .input-group input[data-field="keyword"]');
            var keyword = objTextSearch.val().trim();
            if (!keyword || keyword.length == 0) {
                showAlertInfoFocus('Vui lòng nhập từ khóa tìm kiếm', objTextSearch);
                return;
            }
            searchVehicle('.row-vehicle');
        });

        // Search price
        $('.row-vehicle .box-search-left .box-search-item-price input').on('keypress', function (e) {
            if (e.keyCode == 13 || e.which == 13) {
                $(this).closest('.box-search-item-container').find('button').trigger('click');
            }
        });
        $(".row-vehicle .box-search-left .btn-search-price>.btn").on('click touch', function () {
            var objFromPrice = $('.box-search-left .box-search-item-price input[data-field="fromprice"]');
            var objToPrice = $('.box-search-left .box-search-item-price input[data-field="toprice"]');
            var fromPrice = parseInt(objFromPrice.val());
            var toPrice = parseInt(objToPrice.val());
            if (!fromPrice && !toPrice) {
                showAlertInfoFocus('Vui lòng nhập từ giá hoặc đến giá', objFromPrice);
                return;
            }
            if (fromPrice && fromPrice < 1000) {
                showAlertInfoFocus('Vui lòng nhập từ giá lớn hơn 1.000', objFromPrice);
                return;
            }
            if (toPrice && toPrice < 1000) {
                showAlertInfoFocus('Vui lòng nhập đến giá lớn hơn 1.000', objToPrice);
                return;
            }
            if (fromPrice && toPrice && fromPrice >= toPrice) {
                showAlertInfoFocus("Đến giá phải lớn hơn từ giá", objToPrice);
                return;
            }
            searchVehicle('.row-vehicle');
        });

        // Search select
        $('.row-vehicle .box-search-left select[data-field]').on('changed.bs.select', function (e, clickedIndex, isSelected, previousValue) {
            if (clickedIndex != null && clickedIndex > -1) {
                searchVehicle('.row-vehicle');
            }
        });

        // Clear all search
        $('.row-vehicle .tag-search-product .tag-delete-all').on('click touch', function () {
            $('.row-vehicle .box-search-left .input-group input').val('');
            $('.row-vehicle .box-search-left .box-search-item-price input').val('');
            $('.row-vehicle .box-search-left select.checkboxpicker').find('option:selected').prop("selected", false);
            searchVehicle('.row-vehicle');
        });

        // Sort
        $('.row-vehicle .sort-product .btn-sort').on('click touch', function () {
            $('.row-vehicle .sort-product .btn-sort').removeClass('active');
            $(this).addClass('active');
            searchVehicle('.row-vehicle');
        });

        // View grid or list
        $('.row-vehicle .view-product').find('.view-type').on('click touch', function () {
            $('.row-vehicle .view-product').find('.view-type').removeClass('active');
            $(this).addClass('active');
            var value = $(this).attr('data-value');
            if (value == 'grid') {
                $('.row-vehicle').find('.products-list').removeClass('view-list');
            }
            else {
                $('.row-vehicle').find('.products-list').addClass('view-list');
            }
            addCache('viewvehicle', value);
        });

        $('.row-vehicle .product-item .btn-report-price').on('click touch', function () {
            var temp = $(this).closest('.product-button');
            var vehicleId = parseInt($(temp).attr('data-id'));
            var vehicleName = 'Phiên bản: ' + $(temp).attr('data-name');
            var title = $(temp).attr('data-title');
            $popupVehicle.showPriceQuoteByVehicleId(vehicleId, vehicleName, title);
        });

        $('.row-vehicle .product-item .btn-test-drive').on('click touch', function () {
            var temp = $(this).closest('.product-button');
            var vehicleId = parseInt($(temp).attr('data-id'));
            var vehicleName = 'Phiên bản: ' + $(temp).attr('data-name');
            var title = $(temp).attr('data-title');
            $popupVehicle.showTestDriveVehicle(vehicleId, vehicleName, title);
        });

        // Set value search    
        var keywordSearch = null;
        var fromPrice = null;
        var toPrice = null;
        var sortVehicle = parseInt(getParamValue('o'));
        var viewVehicle = getCache('viewvehicle');
        var enableResultSearch = false;

        $('.row-vehicle .box-search-left input[data-field]').each(function () {
            var field = $(this).attr('data-field');
            switch (field) {
                case 'keyword':
                    keywordSearch = getTextSearch();
                    if (keywordSearch.length > 0) {
                        $(this).val(keywordSearch);
                        enableResultSearch = true;
                    }
                    break;
                case 'fromprice':
                    fromPrice = parseInt(getParamValue('from'));
                    if (fromPrice > 0) {
                        $(this).val(fromPrice);
                        enableResultSearch = true;
                    }
                    break;
                case 'toprice':
                    toPrice = parseInt(getParamValue('to'));
                    if (toPrice > 0) {
                        $(this).val(toPrice);
                        enableResultSearch = true;
                    }
                    break;
            }
        });
        $('.row-vehicle .box-search-left select[data-field]').each(function () {
            var field = $(this).attr('data-field');
            var value = getParamValue(field);
            if (value && value.length > 0) {
                enableResultSearch = true;
            }
            if (field == 'brand') {
                var brandId = parseInt($('.row-vehicle').attr('data-id'));
                if (brandId > 0) {
                    value = (value && value.length > 0) ? value + ',' + brandId : '' + brandId;
                }
            }
            if (value && value.length > 0) {
                $(this).attr("data-value", JSON.stringify(value.split(',')));
            }
            reloadCombobox(this, '.box-search-left', ajax);

            $(this).on('loaded.bs.select', function (e) {
                var type = $(this).attr('data-field');
                var brandId = parseInt($('.row-vehicle').attr('data-id'));
                var instant = this;
                $(this).find('option:selected').each(function () {
                    var id = $(this).attr('value');
                    var name = $(this).text();
                    if (brandId == parseInt(id)) {
                        $(this).remove();
                        $(instant).selectpicker('refresh');
                    }
                    else {
                        addItemSearchVehicle(type, id, name);
                    }
                });
            });
        });
        if (keywordSearch != null && keywordSearch.length > 0) {
            addItemSearchVehicle('search', -1, 'Từ khóa: ' + keywordSearch);
        }
        if (fromPrice > 0 && toPrice > 0) {
            addItemSearchVehicle('price', -1, 'Giá: ' + formatNumber(fromPrice) + ' - ' + formatNumber(toPrice));
        }
        else if (fromPrice > 0) {
            addItemSearchVehicle('price', -1, 'Giá từ: ' + formatNumber(fromPrice));
        }
        else if (toPrice > 0) {
            addItemSearchVehicle('price', -1, 'Giá đến: ' + formatNumber(toPrice));
        }
        if (sortVehicle && sortVehicle > 1) {
            $('.row-vehicle .sort-product .btn-sort').removeClass('active');
            $('.row-vehicle .sort-product .btn-sort[data-value="' + sortVehicle + '"]').addClass('active');
        }
        if (viewVehicle && viewVehicle.length > 0) {
            $('.row-vehicle .view-product').find('.view-type[data-value="' + viewVehicle + '"]').trigger('click');
        }
        if (enableResultSearch) {
            $('.row-vehicle .tag-search-product').removeClass('none');
        }
    }
}
function processPriceListPage(ajax) {
    if (window.pageKey == 'pricelist' || window.pageKey == 'truckpricelist') {
        // Search keyword
        $('.p-bang-gia-xe-1 .search-box-header.input-group input').on('keypress', function (e) {
            if (e.keyCode == 13 || e.which == 13) {
                searchPriceList('.p-bang-gia-xe-1');
            }
        });
        $('.p-bang-gia-xe-1 .search-box-header.input-group button').on('click touch', function () {            
            searchPriceList('.p-bang-gia-xe-1');
        });

        // Search select
        $('.p-bang-gia-xe-1 .search-box-header select[data-field]').on('changed.bs.select', function (e, clickedIndex, isSelected, previousValue) {
            if (clickedIndex != null && clickedIndex > -1) {
                searchPriceList('.p-bang-gia-xe-1');
            }
        });

        // Set value search
        $('.p-bang-gia-xe-1 .search-box-header input[data-field="keyword"]').each(function () {
            setTextSearch(this);
        });
        $('.p-bang-gia-xe-1 .search-box-header select[data-field]').each(function () {
            var field = $(this).attr('data-field');
            if (field == 'price') {
                var fromPrice = parseInt(getParamValue('from'));
                var toPrice = parseInt(getParamValue('to'));
                if (!toPrice) {
                    toPrice = -1;
                }
                if (fromPrice > 0) {
                    $(this).find('option[data-from="' + fromPrice + '"][data-to="' + toPrice + '"]').attr('selected', 'selected');
                }
            }
            else {
                var value = parseInt(getParamValue(field));
                if (value > 0) {
                    $(this).attr("data-value", value);
                }
            }
            reloadCombobox(this, '.p-bang-gia-xe-1', ajax);
        });
    }
}
function processDetailBrandPage(ajax) {
    if (window.pageKey == 'branddetail') {
        $('.banner-thuonghieu .brand-report-price-icon a').on('click touch', function () {
            var brandName = $('h1.products-name').text();
            $popupVehicle.showPriceQuoteModel('dealer', -1, parseInt(window.pageId), -1, brandName);
        });
        $('.banner-thuonghieu .brand-test-icon a').on('click touch', function () {
            var brandName = $('h1.products-name').text();
            $popupVehicle.showTestDriveModel('dealer', -1, parseInt(window.pageId), -1, brandName);
        });
    }
}
function processDetailDealerPage(ajax) {
    if (window.pageKey == 'dealerdetail') {
        $('.box-showroom-info .brand-report-price-icon a,.col-right .support-info .pricequote,#menu-fixed-bottom .pricequote').on('click touch', function () {
            $popupVehicle.showPriceQuoteModel('dealer', parseInt(window.pageId), parseInt(window.brand), -1, window.brandname);
        });
        $('.box-showroom-info .brand-test-icon a,.col-right .support-info .testdrive').on('click touch', function () {
            $popupVehicle.showTestDriveModel('dealer', parseInt(window.pageId), parseInt(window.brand), -1, window.brandname);
        });
        $('.products-list .product-item .btn-report-price').on('click touch', function () {
            var temp = $(this).closest('.product-button');
            var vehicleName = 'Phiên bản: ' + $(temp).attr('data-name');
            var title = $(temp).attr('data-title');
            var lstData = $ads.getDataByPageId('dealer', parseInt(window.pageId), window.pageKey);
            $popupVehicle.showPriceQuote($popupVehicle.priceQuoteType.InputVehicle, lstData, -1, -1, -1, title, vehicleName);
        });
        $('.products-list .product-item .btn-test-drive').on('click touch', function () {
            var temp = $(this).closest('.product-button');
            var vehicleName = 'Phiên bản: ' + $(temp).attr('data-name');
            var title = $(temp).attr('data-title');
            var lstData = $ads.getDataByPageId('dealer', parseInt(window.pageId), window.pageKey);
            $popupVehicle.showTestDrive($popupVehicle.testDriveType.Vehicle, lstData[0], -1, -1, title, vehicleName);
        });
        $('#menu-fixed-bottom .btn-close').on('click touch', function () {
            $('#menu-fixed-bottom').addClass('none');
        });

        var supportInfo = $(".col-right .support-info");
        if (supportInfo && supportInfo.length > 0) {
            var topTarget = supportInfo.offset() ? supportInfo.offset().top : 0;
            $(window).scroll(function () {
                if ($(this).scrollTop() > topTarget) {
                    $("body").addClass('support-info-fixed');
                } else {
                    $("body").removeClass('support-info-fixed');
                }
            });
        }
    }
}
function processDetailModelPage(ajax) {
    if (window.pageKey == 'modeldetail') {
        $('.col-right [data-type="ads"][data-adtype="pricelist"]').each(function () {
            $ads.setHtmlPriceList(this, '<div class="support-info-fixed"></div>');
        });
        $costEstimate.calcDetailModelPage(ajax);

        $compareSpecification.initDetailModel();        
    }
}
function processDetailVehiclePage(ajax) {
    if (window.pageKey == 'vehicledetail') {
        $('.col-right [data-type="ads"][data-adtype="pricelist"]').each(function () {
            $ads.setHtmlPriceList(this, '<div class="support-info-fixed"></div>');
        });

        // Load specs
        var groupId = -1;
        var groupName = '';
        var htmlSpecs = '';
        var html = '';
        $('.box-compare.box-special>p').each(function () {
            var groupIdTemp = parseInt($(this).attr('data-group'));
            if (groupId != groupIdTemp) {
                if (groupId > -1) {
                    if (htmlSpecs.length > 0) {
                        htmlSpecs = '<table>' + htmlSpecs + '</table>';
                    }
                    html += '<div class="compare-detail table-responsive"><p class="compare-title collapsed" data-toggle="collapse" data-target="#specgroup' + groupId + '">' + groupName + '</p><div id="specgroup' + groupId + '" class="collapse">' + htmlSpecs + '</div></div>';
                    htmlSpecs = '';
                }
                groupId = groupIdTemp;
                groupName = $(this).attr('data-groupname');
            }
            htmlSpecs += '<tr><td><strong>' + $(this).find('span:first-child').text() + '</strong></td><td>' + $(this).find('span:last-child').text() + '</td></tr>';
        });
        if (groupId > -1) {
            if (htmlSpecs.length > 0) {
                htmlSpecs = '<table>' + htmlSpecs + '</table>';
            }
            html += '<div class="compare-detail table-responsive"><p class="compare-title collapsed" data-toggle="collapse" data-target="#specgroup' + groupId + '">' + groupName + '</p><div id="specgroup' + groupId + '" class="collapse">' + htmlSpecs + '</div></div>';
        }
        $('.box-compare.box-special').html('<div class="compare-special table-responsive">' + html + '</div>');

        $costEstimate.calcDetailVehiclePage(ajax);
    }
}
function processCompareSpecificationPage(ajax) {    
    if (window.pageKey == 'comparespecification') { 
        $compareSpecification.init(4);
    }
 }    
function processDetailPriceListPage(ajax) {
    if (window.pageKey == 'pricelistdetail') {
        $('.product-price-list .product-price-body .product-button>.btn.pricequote').on('click touch', function () {
            var temp = $(this).closest('.product-price-body');
            var priceListId = parseInt(window.pageId);
            var brandId = parseInt(window.brand);
            var modelId = parseInt($(temp).attr('data-id'));
            var modelName = $(temp).attr('data-name');
            $popupVehicle.showPriceQuoteVehicle('pricelist', priceListId, brandId, modelId, modelName);
        });
        $('.product-price-list .product-price-body .product-button>.btn.testdrive').on('click touch', function () {
            var priceListId = parseInt(window.pageId);
            var brandId = parseInt(window.brand);
            var modelId = parseInt($(this).closest('.product-price-body').attr('data-id'));
            $popupVehicle.showTestDriveModel('pricelist', priceListId, brandId, modelId, window.brandname);
        });

        $costEstimate.calcEstimateinstallmentPopup(ajax);
    }
}
function processCostEstimatePage(ajax) {
    if (window.pageKey == 'costestimate') { 
        $costEstimate.calcCostEstimatePage(ajax);
    }
}
function processSearchPage() {
    if (window.pageKey == 'search' || window.pageKey == 'searchlist') {
        $search.init();
    }
}
function processHomePage() {
    if (window.pageKey == 'home') {
        $('.banner-container .banner-search-box').find('input').on('keyup', function (event) {
            if (event.keyCode === 13) {
                $search.search($(this).val());
            }
        });

        $('.banner-container .banner-search-box').find('.btn-search').on('click touch', function (event) {
            var keyword = $('.banner-container .banner-search-box').find('input').val();
            $search.search(keyword);
        });

        $('.banner-search-box .btn-form-delete').on('click touch', function () {
            $(this).parent().find('input').val('').focus();
        });

        $('.banner-container .banner-search-box').find('input').on('keyup paste', function (event) {
            $search.eventInputSearchText('.banner-search-box',event);
        });

        var container = $('.suggest-list');
        $(document).on('mouseup', function (e) {
            if (!container.is(e.target) && container.has(e.target).length === 0) {
                container.hide();
            }
        });
        $(document).on('keydown', function (e) {
            $search.trackingActiveSuggest(e);
        });
    }
}
function alcoholcalculator() {
    if ($(".box-alcoholcalculator")[0]) {
        var varDef = {
            aDoCon: 0.79,
            rNam: 0.7,
            rNu: 0.6,
            tHapThu: 0.015,
            bNongDoKhiTho: 210,
            cNongDoTrongMau: 1.056,
        };
        var weight = 65;
        var volume = 5;
        var concentration = 120;

        //Set default data
        $('.alcoholcalculator-item input[data-field="weight"]').val(weight);
        $('.alcoholcalculator-item input[data-field="volume"]').val(volume);
        $('.alcoholcalculator-item input[data-field="concentration"]').val(concentration);

        $('.btn-gender').on('click touch', function () {
            $('.btn-gender').removeClass("active");
            $(this).addClass("active");
            var gender = $(this).attr("data-value");
            calc(gender);
        })

        $('.alcoholcalculator-item input[data-field]').on('input', function () {
            var value = $(this).val();
            if (value > 0) {
                $(".result-drunk").show();
                var gender = $(".btn-gender.active").attr("data-value");
                calc(gender);
            }
            else {
                $(".result-drunk").hide();
            }
        })

        var calc = function (gender) {
            var data = null;
            weight = $('.alcoholcalculator-item input[data-field="weight"]').val();
            volume = $('.alcoholcalculator-item input[data-field="volume"]').val();
            concentration = $('.alcoholcalculator-item input[data-field="concentration"]').val();

            if (!weight || !volume || !concentration) {
                return;
            }
            try {
                var A = (varDef.aDoCon * volume * concentration) / 100;
                var r = gender == "male" ? varDef.rNam : varDef.rNu;
                data = {};
                var C = (varDef.cNongDoTrongMau * A) / (10 * weight * r);
                var B = (C * 1000) / varDef.bNongDoKhiTho;
                var T = C / varDef.tHapThu;

                data.C = parseFloat((C * 1000).toFixed(3));
                data.B = parseFloat(B.toFixed(3));
                data.T = parseFloat(T.toFixed(1));
                if (data.C <= 0 || data.B <= 0 || data.T <= 0) {
                    return;
                }

                if (data) {
                    $('span[data-value=b]').text(data.B);
                    $('span[data-value=c]').text(data.C);
                    $('span[data-value=t]').text(data.T);
                }
            }
            catch {}
        }
        $('.btn-male').trigger('click');
    }
}
$(document).ready(function () {
    $(window).scroll(function () {
        if ($(this).scrollTop() > 100) {
            $('#back-top').fadeIn();
        }
        else {
            $('#back-top').fadeOut();
        }
    });
    $('#back-top').on('click touch', function () {
        $('html, body').animate({ scrollTop: 0 }, 800);
        return false;
    });
    $('[data-spy="scroll"]').on('activate.bs.scrollspy', function () {
        $(".list-group-item").removeClass("active");
    });
    $('a.list-group-item,a.gotolink').on('click touch', function () {
        if (location.hostname == this.hostname) {
            var target = $(this.hash);
            target = target.length ? target : $('[name=' + this.hash.slice(1) + ']');
            if (target.length) {
                $("html").animate({
                    scrollTop: target.offset().top - 5
                }, 800);
                return false;
            }
        }
    });
    $('.btn-expand-all').on('click touch', function () {
        var target = $(this).attr('data-target');
        if ($(this).hasClass("expanded")) {
            $(this).removeClass("expanded").attr('title', 'Mở hết');
            $(target).find('.collapse').collapse("hide");
        }
        else {
            $(this).addClass("expanded").attr('title', 'Đóng hết');
            $(target).find('.collapse').collapse("show");
        }
    });
    $('.owl-banner,.owl-banner-full').owlCarousel({
        navText: ["<i class='fa fa-angle-left'></i>", "<i class='far fa-angle-right'></i>"],
        nav: true,
        margin: 0,
        dots: true,
        items: 1,
        autoplay: true,
        autoplayTimeout: 5000,
        responsiveClass: true,
        lazyLoad: true,
        loop: false
    });
    $('.owl-bang-gia-xe-home').owlCarousel({
        navText: ["<i class='fa fa-angle-left'></i>", "<i class='far fa-angle-right'></i>"],
        loop: false,
        nav: true,
        margin: 20,
        dots: false,
        autoWidth: true,
        items: 8
    });
    $('.owl-showroom-highlights, .owl-car-highlights').owlCarousel({
        navText: ["<i class='fa fa-angle-left'></i>", "<i class='far fa-angle-right'></i>"],
        loop: false,
        nav: true,
        margin: 20,
        dots: false,
        autoWidth: true,
        items: 4
    });
    $('.dongxe-carousel').owlCarousel({
        navText: ["<i class='fa fa-angle-left'></i>", "<i class='far fa-angle-right'></i>"],
        nav: true,
        loop: false,
        margin: 10,
        dots: false,
        autoWidth: true,
        items: 4
    });
    $('.owl-post').owlCarousel({
        navText: ["<i class='fa fa-angle-left'></i>", "<i class='far fa-angle-right'></i>"],
        loop: false,
        nav: true,
        margin: 20,
        autoWidth: true,
        items: 4,
    });
    $('.news-item span.time').each(function () {
        var ticks = parseInt($(this).attr('data-value'));
        var res = getTime(ticks);
        if (res.length > 0) {
            $(this).text(res);
        }
    });
    $('.video-main-more-list .video-item a').on('click touch', function () {
        var target = $(this).closest('.video-item').attr('data-target');
        var videoCode = $(this).closest('.video-item').attr('data-code');
        if (videoCode && videoCode.length > 0) {
            $(target).find('iframe').attr('src', 'https://www.youtube.com/embed/' + videoCode + '?autoplay=1&enablejsapi=1&rel=0');
        }
        $(this).closest('.video-main-more-list').find('.video-item').removeClass('active');
        $(this).closest('.video-item').addClass('active');
    });
    $('.header-main .navbar-nav .nav-item.dropdown').each(function () {
        var url = $(this).find('.nav-link').attr('href');
        if (url == '/danh-sach-xe-oto/') {
            var htmlBodyType = '';
            var htmlVehicleList = '';
            $(this).find('.dropdown-menu .dropdown-item').each(function () {
                var type = $(this).attr('data-type');
                var urlImage = $(this).attr('data-img');
                var text = $(this).text();
                $(this).html('<img src="' + urlImage + '"><h6 class="nav-title">' + text + '</h6>');
                $(this).removeAttr('data-type data-img');
                if (type == 'vehiclelist') {
                    htmlVehicleList += $(this).prop('outerHTML');
                }
                else {
                    htmlBodyType += $(this).prop('outerHTML');
                }
            });
            if (htmlVehicleList.length > 0) {
                htmlVehicleList =   '<div class="col-6">' +
                                    '   <div class="dropdown-menu-container-2">' +
                                    '       <h6 class="dropdown-menu-title">Thương hiệu</h6>' + htmlVehicleList +
                                    '       <div class="dropdown-item-view-all justify-content-end">' +
                                    '           <a class="btn-view-all" href="https://dailyxe.com.vn/danh-sach-xe-oto/" title="Tất cả thương hiệu">Tất cả thương hiệu <i class="fas fa-angle-double-right"></i></a>' +
                                    '       </div>'+
                                    '   </div>' +
                                    '</div>';
            }
            if (htmlBodyType.length > 0) {
                htmlBodyType =  '<div class="col-6">' +
                                '   <div class="dropdown-menu-container-2">' +
                                '       <h6 class="dropdown-menu-title">Loại xe</h6>' + htmlBodyType +
                                '   </div>' +
                                '</div>';
            }

            $(this).addClass('dropdown-menu-grid');
            $(this).find('.dropdown-menu').html('<div class="container"><div class="row">' + htmlVehicleList + htmlBodyType + '</div></div>');
        }
        else if (url == '/thuong-hieu/' || url == '/bang-gia-xe-oto/' || url == '/bang-gia-xe-tai/') {
            $(this).find('.dropdown-menu .dropdown-item').each(function () {
                var urlImage = $(this).attr('data-img');
                var text = $(this).text();
                $(this).html('<img src="' + urlImage + '"><h6 class="nav-title">' + text + '</h6>');
                $(this).removeAttr('data-type data-img');
            });

            $(this).addClass('dropdown-menu-grid');
            var html = $(this).find('.dropdown-menu').html();
            if (url == '/thuong-hieu/') {
                $(this).find('.dropdown-menu').html('<div class="container">' + html + '<div class="dropdown-item-view-all justify-content-end"><a class="btn-view-all" href="https://dailyxe.com.vn/thuong-hieu/" title="Tất cả thương hiệu">Tất cả thương hiệu <i class="fas fa-angle-double-right"></i></a></div></div>');
            }
            else if (url == '/bang-gia-xe-oto/') {
                $(this).find('.dropdown-menu').addClass('dropdown-bang-gia-xe');
                $(this).find('.dropdown-menu').html('<div class="container">' + html + '<div class="dropdown-item-view-all justify-content-end"><a class="btn-view-all" href="https://dailyxe.com.vn/bang-gia-xe-oto/" title="Giá xe ô tô các thương hiệu">Giá xe ô tô các thương hiệu <i class="fas fa-angle-double-right"></i></a></div></div>');
            }
            else if (url == '/bang-gia-xe-tai/') {
                $(this).find('.dropdown-menu').addClass('dropdown-bang-gia-xe');
                $(this).find('.dropdown-menu').html('<div class="container">' + html + '<div class="dropdown-item-view-all justify-content-end"><a class="btn-view-all" href="https://dailyxe.com.vn/bang-gia-xe-tai/" title="Giá xe tải các thương hiệu">Giá xe tải các thương hiệu <i class="fas fa-angle-double-right"></i></a></div></div>');
            }
        }
    });

    $('#frmContactUs a.btn').on('click touch', function () {
        sendContact(null, '#frmContactUs');
    });

    if ($('#menu-list')[0]) {
        $('body').attr('data-spy', 'scroll').attr('data-target', '#menu-list');
    }
    if ($('.color-picker')[0]) {
        var owlVehicle = $('.owl-banner-vehicle').owlCarousel({
            navText: ["<i class='fa fa-angle-left'></i>", "<i class='far fa-angle-right'></i>"],
            nav: true,
            margin: 0,
            dots: true,
            items: 1,
            autoplay: true,
            autoplayTimeout: 5000,
            responsiveClass: true,
            lazyLoad: true,
            loop: false,
        });
        $('.color-picker .mode-picker>a').on('click touch', function () {
            var filter = '.furniture';
            var activeClass = 'exterior';
            if ($(this).hasClass('exterior-item')) {
                filter = '.exterior';
                activeClass = 'furniture';
            }
            $('.color-picker .mode-picker').removeClass('furniture exterior').addClass(activeClass);
            owlVehicle.owlCarouselFilter(filter);
        });
        $('.color-picker a.color-item.color-general').on('click touch', function () {
            $('.color-picker .mode-picker').removeClass('furniture exterior').addClass('furniture');
            owlVehicle.owlCarouselFilter('*');
        });
    }
    $('#showroom .selectpicker').each(function () {
        loadListToCombobox(this, getDataCities());
        $('#showroom .showroom-list').prepend('<p class="empty-data none">Không tìm thấy showroom.</p>');
        $(this).on('change', function () {
            var cityId = parseInt($(this).val());
            $('#showroom .showroom-list .showroom-item').each(function () {
                var tempId = parseInt($(this).attr('data-city'));
                if (cityId == -1 || cityId == tempId) {
                    $(this).removeClass('none');
                }
                else {
                    $(this).addClass('none');
                }
            });
            if ($('#showroom .showroom-list .showroom-item:not(.none)')[0]) {
                $('#showroom .empty-data').addClass('none');
            }
            else {
                $('#showroom .empty-data').removeClass('none');
            }

        });
    });

    $("input.number").each(function () {
        $(this).number(true);
    });

    //kiểm tra gọi thư viện splitter để so sánh ảnh trong chi tiết bài viết.
    if ($(".splitter-container")[0] && typeof splitter != undefined) {
        $(".splitter-container").splitter();
    }

    // Page alcoholcalculator
    alcoholcalculator();
    processHomePage();
    processDealerPage($ajax);
    processVehiclePage($ajax);
    processPriceListPage($ajax);
    processDetailBrandPage($ajax);
    processDetailDealerPage($ajax);
    processDetailPriceListPage($ajax);
    processDetailModelPage($ajax);
    processDetailVehiclePage($ajax);
    processCompareSpecificationPage($ajax);
    processCostEstimatePage($ajax);
    processSearchPage();
});